var beaPostOffline={init:function(){previous_status="no";checkbox_state=jQuery("#enable-offline").is(":checked");jQuery("#offline-timestampdiv").siblings("a.edit-offline-timestamp").click(function(){if(jQuery("#offline-timestampdiv").is(":hidden")){jQuery("#offline-timestampdiv").slideDown("fast");jQuery("#offline_timestamp").hide();jQuery(this).hide()}return false});jQuery(".offline-timestamp-wrap input, .offline-timestamp-wrap select").change(function(){jQuery("#enable-offline").attr("checked","checked")});jQuery(".cancel-offline-timestamp","#offline-timestampdiv").click(function(){jQuery("#offline-timestampdiv").slideUp("fast");jQuery("#offline-mm").val(jQuery("#offline-hidden_mm").val());jQuery("#offline-jj").val(jQuery("#offline-hidden_jj").val());jQuery("#offline-aa").val(jQuery("#offline-hidden_aa").val());jQuery("#offline-hh").val(jQuery("#offline-hidden_hh").val());jQuery("#offline-mn").val(jQuery("#offline-hidden_mn").val());jQuery("#enable-offline").attr("checked",checkbox_state);beaPostOffline.restorePreviousStatus();jQuery("#offline_timestamp").show();jQuery("#offline-timestampdiv").siblings("a.edit-offline-timestamp").show();beaPostOffline.updateText(false);return false});jQuery(".save-offline-timestamp","#offline-timestampdiv").click(function(){if(beaPostOffline.updateText(true)){jQuery("#offline-timestampdiv").slideUp("fast");jQuery("#offline_timestamp").show();jQuery("#offline-timestampdiv").siblings("a.edit-offline-timestamp").show()}return false})},updateText:function(e){var a,d,b,f,c=jQuery("#enable-offline").is(":checked");aa=jQuery("#offline-aa").val(),mm=jQuery("#offline-mm").val(),jj=jQuery("#offline-jj").val(),hh=jQuery("#offline-hh").val(),mn=jQuery("#offline-mn").val();a=new Date(aa,mm-1,jj,hh,mn);d=new Date(jQuery("#offline-hidden_aa").val(),jQuery("#offline-hidden_mm").val()-1,jQuery("#offline-hidden_jj").val(),jQuery("#offline-hidden_hh").val(),jQuery("#offline-hidden_mn").val());b=new Date(jQuery("#offline-cur_aa").val(),jQuery("#offline-cur_mm").val()-1,jQuery("#offline-cur_jj").val(),jQuery("#offline-cur_hh").val(),jQuery("#offline-cur_mn").val());if(a.getFullYear()!=aa||(1+a.getMonth())!=mm||a.getDate()!=jj||a.getMinutes()!=mn){jQuery(".offline-timestamp-wrap","#offline-timestampdiv").addClass("form-invalid");return false}else{jQuery(".offline-timestamp-wrap","#offline-timestampdiv").removeClass("form-invalid")}if(c==true&&a>b){f=beaPostL10n.schedule;if(e==true){beaPostOffline.restorePreviousStatus()}}else{if(c==true&&a<=b){f=beaPostL10n.since;if(e==true){beaPostOffline.setPostStatus("offline")}}else{f=beaPostL10n.never;if(e==true){beaPostOffline.restorePreviousStatus()}}}if(f==beaPostL10n.never){jQuery("#offline_timestamp").html(f)}else{jQuery("#offline_timestamp").html(f+" <b>"+jQuery('option[value="'+jQuery("#offline-mm").val()+'"]',"#offline-mm").text()+" "+jj+", "+aa+" @ "+hh+":"+mn+"</b> ")}return true},setPostStatus:function(a){if(previous_status=="no"){previous_status=jQuery("select#post_status option:selected").val()}jQuery("select#post_status option").each(function(){jQuery(this).attr("selected",(jQuery(this).attr("value")==a))});jQuery(".save-post-status").click()},restorePreviousStatus:function(){if(previous_status!="no"){beaPostOffline.setPostStatus(previous_status);previous_status="no"}else{var a=jQuery("#original_post_status").val();if(a=="auto-draft"){a="draft"}beaPostOffline.setPostStatus(a)}}};jQuery(document).ready(function(){beaPostOffline.init()});